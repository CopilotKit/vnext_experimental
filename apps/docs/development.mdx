---
title: "Development"
description: "Development workflow and best practices for CopilotKit 2.0"
---

## Development Workflow

CopilotKit 2.0 uses a modern development stack with pnpm workspaces and Turborepo for optimal developer experience.

## Workspace Structure

The project is organized as a monorepo with the following structure:

### Packages

- **`packages/runtime`** - Core server-side functionality
- **`packages/shared`** - Common utilities and types
- **`packages/eslint-config`** - Shared ESLint configurations
- **`packages/typescript-config`** - TypeScript configuration presets

### Apps

- **`apps/docs`** - Documentation site (Mintlify)

## Development Commands

<CodeGroup>

```bash Core Development
# Start development mode for all packages
pnpm dev

# Build all packages
pnpm build

# Run tests across all packages
pnpm test

# Watch mode for tests
pnpm test:watch
```

```bash Quality Assurance
# Run linting across all packages
pnpm lint

# Format code with Prettier
pnpm format

# Type checking
pnpm check-types

# Test coverage
pnpm test:coverage
```

</CodeGroup>

## Package Management

<Warning>
  Always use `pnpm` for package management. Never use `npm` or `yarn` in this
  project.
</Warning>

### Adding Dependencies

```bash
# Add a dependency to the workspace root
pnpm add -w <package-name>

# Add a dependency to a specific package
pnpm add <package-name> --filter @copilotkit/runtime

# Add a dev dependency
pnpm add -D <package-name> --filter @copilotkit/shared
```

### Workspace Dependencies

To depend on another package in the workspace:

```json
{
  "dependencies": {
    "@copilotkit/shared": "workspace:*"
  }
}
```

## Testing Strategy

### Vitest Configuration

Each package has its own Vitest configuration:

```javascript
// vitest.config.mjs
import { defineConfig } from "vitest/config";

export default defineConfig({
  test: {
    environment: "node", // or "jsdom" for React components
    globals: true,
    // package-specific settings
  },
});
```

### Running Tests

<CodeGroup>

```bash All Tests
# Run all tests
pnpm test

# Watch mode
pnpm test:watch

# Coverage report
pnpm test:coverage
```

```bash Package-Specific
# Test specific package
pnpm test --filter @copilotkit/runtime

# Watch specific package
pnpm test:watch --filter @copilotkit/shared
```

</CodeGroup>

## Code Quality

### TypeScript

- All packages use strict TypeScript configuration
- Shared TypeScript configs in `packages/typescript-config`
- Type checking is part of the CI pipeline

### ESLint

- Shared ESLint configurations in `packages/eslint-config`
- Different configs for different environments (Node.js, React, etc.)
- Auto-fixing available with `pnpm lint --fix`

### Prettier

- Consistent code formatting across all packages
- Configuration in root `package.json`
- Integrated with ESLint to avoid conflicts

## Build System

### Turborepo

The project uses Turborepo for efficient builds and caching:

```json
// turbo.json
{
  "pipeline": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": ["dist/**"]
    },
    "test": {
      "dependsOn": ["build"]
    }
  }
}
```

### Build Outputs

<Note>
  Never commit build outputs (`dist/`, `.next/`, `node_modules/`) to version
  control.
</Note>

## Contributing Guidelines

### Commit Messages

Follow conventional commit format:

```
feat(runtime): add new handler for agents
fix(shared): resolve utility function bug
docs: update API documentation
```

### Pull Requests

1. Create a feature branch from `main`
2. Make your changes with appropriate tests
3. Ensure all checks pass (`pnpm lint`, `pnpm test`, `pnpm check-types`)
4. Submit a pull request with a clear description

### Code Review

- All changes require review before merging
- Automated checks must pass
- Consider backward compatibility for public APIs

## Debugging

### VS Code Setup

Recommended VS Code extensions:

- TypeScript and JavaScript Language Features
- ESLint
- Prettier
- Vitest Extension

### Debug Configuration

```json
// .vscode/launch.json
{
  "configurations": [
    {
      "type": "node",
      "request": "launch",
      "name": "Debug Tests",
      "program": "${workspaceFolder}/node_modules/.bin/vitest",
      "args": ["run"],
      "console": "integratedTerminal"
    }
  ]
}
```

## Performance Optimization

### Build Caching

Turborepo provides intelligent caching:

```bash
# Clear cache if needed
pnpm turbo clean

# View cache info
pnpm turbo info
```

### Dependency Management

- Use exact versions for critical dependencies
- Regular dependency updates with security audits
- Minimize bundle size with tree-shaking

<Tip>
  For the best development experience, make sure to have the latest version of
  Node.js (18+) and pnpm installed.
</Tip>
